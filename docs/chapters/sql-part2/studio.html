<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>14.5. Studio: Databases, Part 2 &#8212; Java Web Development  documentation</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/fa/css/all.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/launchcode.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/site.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Index" href="../../genindex.html" />
    <link rel="prev" title="14.4. Exercises: SQL, Part 2" href="exercises.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body class="body-bc">

<div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><span><img src="../../_static/lc-ed-logo.png" alt="LaunchCode logo"></span>
        </a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
    <label for="q" class="searchLabel">Search</label>
    <input type="text" name="q" class="form-control" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<ol class="breadcrumb container">
    <li><a href="../../index.html">Contents</a></li>
    <li><a href="index.html">14. The SQL Sequel</a></li>
    <li class="active">14.5. Studio: Databases, Part 2</li>
</ol>



<div class="container">
  <div class="row">
    <div class="col-md-10 col-md-offset-1 content ">

    
  <div class="section" id="studio-databases-part-2">
<h1>14.5. Studio: Databases, Part 2<a class="headerlink" href="#studio-databases-part-2" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div>Note: The content below is pulled from the old unit 2 curriculum.</div></blockquote>
<div class="section" id="walkthrough">
<h2>14.5.1. Walkthrough<a class="headerlink" href="#walkthrough" title="Permalink to this headline">¶</a></h2>
<p>In this studio we’ll be working in MAMP using the tool <em>phpMyAdmin</em>. We’ll
create a new user account and associated database for our <code class="docutils literal notranslate"><span class="pre">movie-buff</span></code>
project. Then we’ll import a <code class="docutils literal notranslate"><span class="pre">.sql</span></code> file and get the tables we’ll use from
that. Then we’ll perform some queries on that data.</p>
<div class="section" id="database-setup">
<h3>14.5.1.1. Database Setup<a class="headerlink" href="#database-setup" title="Permalink to this headline">¶</a></h3>
<p>Let’s start by setting up a new database for this project with a new,
associated user account.</p>
<p>Start up MAMP. From the launcher window, select <em>Start Servers</em>. Once that
button has turned green, choose <em>Open Start Page</em>. From the page that opens up
in your browser, select <em>Tools &gt; phpMyAdmin</em>.</p>
<p>Select <em>Users</em> (on a Mac it will be called <em>User accounts</em>).</p>
<blockquote>
<div>Screenshot here…</div></blockquote>
<p>Fill out the resulting form with info for your application. A good pattern to
follow is that you should have a different user for each application, and the
username should match the name of your application.</p>
<p>Set the <em>Host name</em> field to <em>Local</em> and set a password. For local
development, it’s acceptable to use a simple password. Just be sure that you
don’t use the same password on a production database if you deploy your
application!</p>
<p>And be sure to check the first checkbox under <em>Database for user account</em>. If
you don’t do this, you’ll have to create a database and set permissions
manually. The image below shows what your settings for this user should look
like.</p>
<blockquote>
<div>Screenshot here…</div></blockquote>
<p>Finally, press the small <em>Go</em> button at the bottom.</p>
</div>
<div class="section" id="import-tables-from-sql">
<h3>14.5.1.2. Import Tables From <code class="docutils literal notranslate"><span class="pre">.sql</span></code><a class="headerlink" href="#import-tables-from-sql" title="Permalink to this headline">¶</a></h3>
<p>You should see the database name <cite>movie-buff</cite> on the left side. Double click
on it to go into that database.</p>
<p>Now, download this SQL file: [movie-buff.sql](<a class="reference external" href="https://www.dropbox.com/s/7qc2gnpdtz9uivq/movie-buff.sql?dl=1" target="_blank">https://www.dropbox.com/s/7qc2gnpdtz9uivq/movie-buff.sql?dl=1<i class="fas fa-external-link-alt" aria-hidden="true"></i></a>).</p>
<p>Then click the <em>Import</em> tab. Browse your computer to find the
<code class="docutils literal notranslate"><span class="pre">movie-buff.sql</span></code> file you downloaded (on a Mac it may be
<code class="docutils literal notranslate"><span class="pre">movie-buff.sql.txt</span></code>). Leave all the default selections as they are (the
blue boxes with checks), so your screen should look like this:</p>
<blockquote>
<div>Screenshot here…</div></blockquote>
<p>Now press the <em>Go</em> button at the bottom.</p>
<p>Your screen will now look something like below:</p>
<blockquote>
<div>Screenshot here…</div></blockquote>
<p>You can click on the database <code class="docutils literal notranslate"><span class="pre">movie-buff</span></code> on the left side and it should
now look like this:</p>
<blockquote>
<div>Screenshot here…</div></blockquote>
</div>
</div>
<div class="section" id="studio">
<h2>14.5.2. Studio<a class="headerlink" href="#studio" title="Permalink to this headline">¶</a></h2>
<p>Sarah has a very eclectic taste in movies, but her friends admire it. Over the
years, they’ve borrowed a lot of her DVDs, and she’s set up a database to keep
track of who has watched what so that she can make better recommendations for
them based on what they’ve seen so far.</p>
<p>There are four tables in the <code class="docutils literal notranslate"><span class="pre">movie-buff</span></code> database: <code class="docutils literal notranslate"><span class="pre">movies</span></code>,
<code class="docutils literal notranslate"><span class="pre">directors</span></code>, <code class="docutils literal notranslate"><span class="pre">viewers</span></code>, and <code class="docutils literal notranslate"><span class="pre">viewings</span></code>. You can check out the structure
of these tables by going to the “Structure” tab in your database and choosing
a table. This will show you the column names and data types.</p>
<blockquote>
<div>Screenshot here…</div></blockquote>
<p>There is one table Sarah made that might not seem intuitive to have created:
the <code class="docutils literal notranslate"><span class="pre">viewings</span></code> table. The structure of it is here:</p>
<blockquote>
<div>Screenshot here…</div></blockquote>
<p>The purpose of this table is to keep track of “who watched what when”. The
<em>who</em> is the <code class="docutils literal notranslate"><span class="pre">viewer_id</span></code>, which is a foreign key that references the
<code class="docutils literal notranslate"><span class="pre">viewer_id</span></code> in the <code class="docutils literal notranslate"><span class="pre">viewers</span></code> table. The <em>what</em> is the <code class="docutils literal notranslate"><span class="pre">movie_id</span></code> which
is a foreign key that references the <code class="docutils literal notranslate"><span class="pre">movie_id</span></code> in the <code class="docutils literal notranslate"><span class="pre">movies</span></code> table.
And the <em>when</em> is of course the <code class="docutils literal notranslate"><span class="pre">date_viewed</span></code> column with a <code class="docutils literal notranslate"><span class="pre">date</span></code> data
type. Each viewing of a movie by one of Sarah’s friends is captured as a
unique record.</p>
<p>This kind of table is very common in relational database design. It has many
virtues including that it clearly links the <code class="docutils literal notranslate"><span class="pre">movies</span></code> and <code class="docutils literal notranslate"><span class="pre">viewers</span></code> table
together and it makes the database more maintainable. For instance, you might
have chosen to make a <code class="docutils literal notranslate"><span class="pre">viewing</span></code> table where you actually list the movie
title and the name of the viewer. But if you did that then anytime some of
that information changes—say a friend gets married and changes last
names—you would now have to update the name of the viewer in <em>both</em> the
<code class="docutils literal notranslate"><span class="pre">viewers</span></code> table <em>and</em> the <code class="docutils literal notranslate"><span class="pre">viewings</span></code> table. With this design, any updates
you make to either the <code class="docutils literal notranslate"><span class="pre">movies</span></code> or <code class="docutils literal notranslate"><span class="pre">viewers</span></code> table will be reflected
automatically in the results from queries on the <code class="docutils literal notranslate"><span class="pre">viewings</span></code> table.</p>
<p>Review this lesson from <a class="reference external" href="https://www.khanacademy.org/computing/computer-programming/sql/relational-queries-in-sql/a/splitting-data-into-related-tables" target="_blank">Khan Academy<i class="fas fa-external-link-alt" aria-hidden="true"></i></a>
for a more in-depth explanation of why we break tables up this way.</p>
<p>If you get stuck on any of the tasks below, you can review lessons in
<a class="reference external" href="https://www.khanacademy.org/computing/computer-programming/sql" target="_blank">Khan Academy<i class="fas fa-external-link-alt" aria-hidden="true"></i></a> or
<a class="reference external" href="https://www.w3schools.com/sql/default.asp" target="_blank">w3schools<i class="fas fa-external-link-alt" aria-hidden="true"></i></a> to get ideas and
remind yourself of the proper syntax.</p>
</div>
<div class="section" id="your-tasks">
<h2>14.5.3. Your Tasks<a class="headerlink" href="#your-tasks" title="Permalink to this headline">¶</a></h2>
<p>Sarah created these tables and inserted all the data into them, but she needs
your help to run some queries. You can use the <em>SQL</em> tab in the <code class="docutils literal notranslate"><span class="pre">movie-buff</span></code>
database to run queries. Just type your SQL statement(s) in the box and press
the <em>Go</em> button.</p>
<blockquote>
<div>Screenshot here…</div></blockquote>
<p>As an example, say Sarah wants to know the first and last names of any of her
friends who borrowed one of her movies before 2010.</p>
<p>We know we’ll want to use the <cite>viewings</cite> table, since that has the dates of
when people have viewed her DVDs as well as their ids. And we know we want to
use the <code class="docutils literal notranslate"><span class="pre">viewers</span></code> table since that has the first and last names of her
friends. Since we want data from two tables, we know we’ll likely need to use
a <code class="docutils literal notranslate"><span class="pre">join</span></code>. We also know that the column in common between the two tables is
the <code class="docutils literal notranslate"><span class="pre">viewer_id</span></code> column, so that will be what we join on. Our SQL statement
will be:</p>
<div class="highlight-sql notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="k">DISTINCT</span> <span class="n">viewers</span><span class="p">.</span><span class="k">first</span><span class="p">,</span> <span class="n">viewers</span><span class="p">.</span><span class="k">last</span>
<span class="k">FROM</span> <span class="n">viewers</span>
<span class="k">JOIN</span> <span class="n">viewings</span>
<span class="k">ON</span> <span class="n">viewers</span><span class="p">.</span><span class="n">viewer_id</span> <span class="o">=</span> <span class="n">viewings</span><span class="p">.</span><span class="n">viewer_id</span>
<span class="k">WHERE</span> <span class="n">viewings</span><span class="p">.</span><span class="n">date_viewed</span> <span class="o">&lt;</span> <span class="s1">&#39;2010-01-01&#39;</span>
</pre></div>
</td></tr></table></div>
<p>In phpMyAdmin:</p>
<blockquote>
<div>Screenshot here…</div></blockquote>
<p>And the results:</p>
<blockquote>
<div>Screenshot here…</div></blockquote>
<p>Here are some of the things Sarah needs your help with:</p>
<ol class="arabic simple">
<li>Find out which countries the directors in her collection are from (and make
sure your result set only lists each country only once).</li>
<li>Who are the French directors in her database?</li>
<li>What is the date of the first time someone viewed one of Sarah’s movies?</li>
<li>How many movies in her collection were directed by people born in the USA?</li>
<li>What are the titles of the movies in her collection that were directed by
Akira Kurosawa?</li>
<li>How many times has the movie “Talk to Me” been viewed?</li>
<li>When was the last time someone viewed one of her movies?</li>
<li>What is the id of the last-viewed movie?</li>
<li>What is the title of the first movie she loaned to a friend for viewing?</li>
<li>What is the first and last name of the person who viewed the last-viewed
movie?</li>
</ol>
</div>
<div class="section" id="bonus-missions">
<h2>14.5.4. Bonus Missions<a class="headerlink" href="#bonus-missions" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>Write the SQL query to display the DVDs that others have watched in order
of most viewed to least viewed. What’s the title of the most-viewed movie(s)
in Sarah’s collection?</li>
<li>Find the email of everyone who has watched “The Tango Lesson”, so Sarah can
email them and ask what they thought of it.</li>
<li>Sarah is hosting a Kurosawa film festival soon and needs an email list to
send out invites. What are the full names and emails of all her friends who
have watched any movie by Akira Kurosawa?</li>
</ol>
</div>
</div>



    
    <nav aria-label="Next and Previous Pages">
      <ul class="pager">
        
        <li class="previous"><a href="exercises.html"><span aria-hidden="true">&larr;</span> 14.4. Exercises: SQL, Part 2</a></li>
        
        
        <li class="next"><a href="../../genindex.html">Index <span aria-hidden="true">&rarr;</span></a></li>
        
      </ul>
    </nav>
    
    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="../../_sources/chapters/sql-part2/studio.rst.txt"
     rel="nofollow">Page Source</a>
</div>
      
    </p>
    <p>
    </p>
  </div>
</footer>
  </body>
</html>